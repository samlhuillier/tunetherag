nohup: ignoring input
/opt/conda/envs/310/lib/python3.10/site-packages/torch/cuda/__init__.py:546: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
/opt/conda/envs/310/lib/python3.10/site-packages/bitsandbytes/cextension.py:34: UserWarning: The installed version of bitsandbytes was compiled without GPU support. 8-bit optimizers, 8-bit multiplication, and GPU quantization are unavailable.
  warn("The installed version of bitsandbytes was compiled without GPU support. "
Found cached dataset json (/root/.cache/huggingface/datasets/json/default-daae61ee67588246/0.0.0/0f7e3662623656454fcd2b650f34e886a7db4b9104504885bd462096cc7a9f51)
Found cached dataset json (/root/.cache/huggingface/datasets/json/default-bb44d4cc59fac589/0.0.0/0f7e3662623656454fcd2b650f34e886a7db4b9104504885bd462096cc7a9f51)
/opt/conda/envs/310/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cpu.so: undefined symbol: cadam32bit_grad_fp32
{'db_id': 'department_management', 'context': 'CREATE TABLE department (budget_in_billions INTEGER)', 'question': 'What are the maximum and minimum budget of the departments?', 'answer': 'SELECT max(budget_in_billions) ,  min(budget_in_billions) FROM department', 'full_prompt': 'You are a powerful text-to-SQL model. Your job is to answer questions about a database. You are given a question and context regarding one or more tables. You must output the SQL query that answers the question.\n\nGiven the following examples:\nExample 1:\n### Input:\nWhich department has the lowest budget?\n\n### Context:\nCREATE TABLE department (dept_name VARCHAR, budget VARCHAR)\n\n### Response:\nSELECT dept_name FROM department ORDER BY budget LIMIT 1\n\nExample 2:\n### Input:\nWhat is the name and building of the departments whose budget is more than the average budget?\n\n### Context:\nCREATE TABLE department (dept_name VARCHAR, building VARCHAR, budget INTEGER)\n\n### Response:\nSELECT dept_name ,  building FROM department WHERE budget  >  (SELECT avg(budget) FROM department)\n\nExample 3:\n### Input:\nList the creation year, name and budget of each department.\n\n### Context:\nCREATE TABLE department (creation VARCHAR, name VARCHAR, budget_in_billions VARCHAR)\n\n### Response:\nSELECT creation ,  name ,  budget_in_billions FROM department\n\nExample 4:\n### Input:\nFind the name and building of the department with the highest budget.\n\n### Context:\nCREATE TABLE department (dept_name VARCHAR, building VARCHAR, budget VARCHAR)\n\n### Response:\nSELECT dept_name ,  building FROM department ORDER BY budget DESC LIMIT 1\n\nExample 5:\n### Input:\nList the names and buildings of all departments sorted by the budget from large to small.\n\n### Context:\nCREATE TABLE department (dept_name VARCHAR, building VARCHAR, budget VARCHAR)\n\n### Response:\nSELECT dept_name ,  building FROM department ORDER BY budget DESC\n\nPlease generate the SQL query that answers the following:\n### Input:\nWhat are the maximum and minimum budget of the departments?\n\n### Context:\nCREATE TABLE department (budget_in_billions INTEGER)\n\n### Response:\nSELECT max(budget_in_billions) ,  min(budget_in_billions) FROM department', 'inference_prompt': 'You are a powerful text-to-SQL model. Your job is to answer questions about a database. You are given a question and context regarding one or more tables. You must output the SQL query that answers the question.\n\nGiven the following examples:\nExample 1:\n### Input:\nWhich department has the lowest budget?\n\n### Context:\nCREATE TABLE department (dept_name VARCHAR, budget VARCHAR)\n\n### Response:\nSELECT dept_name FROM department ORDER BY budget LIMIT 1\n\nExample 2:\n### Input:\nWhat is the name and building of the departments whose budget is more than the average budget?\n\n### Context:\nCREATE TABLE department (dept_name VARCHAR, building VARCHAR, budget INTEGER)\n\n### Response:\nSELECT dept_name ,  building FROM department WHERE budget  >  (SELECT avg(budget) FROM department)\n\nExample 3:\n### Input:\nList the creation year, name and budget of each department.\n\n### Context:\nCREATE TABLE department (creation VARCHAR, name VARCHAR, budget_in_billions VARCHAR)\n\n### Response:\nSELECT creation ,  name ,  budget_in_billions FROM department\n\nExample 4:\n### Input:\nFind the name and building of the department with the highest budget.\n\n### Context:\nCREATE TABLE department (dept_name VARCHAR, building VARCHAR, budget VARCHAR)\n\n### Response:\nSELECT dept_name ,  building FROM department ORDER BY budget DESC LIMIT 1\n\nExample 5:\n### Input:\nList the names and buildings of all departments sorted by the budget from large to small.\n\n### Context:\nCREATE TABLE department (dept_name VARCHAR, building VARCHAR, budget VARCHAR)\n\n### Response:\nSELECT dept_name ,  building FROM department ORDER BY budget DESC\n\nPlease generate the SQL query that answers the following:\n### Input:\nWhat are the maximum and minimum budget of the departments?\n\n### Context:\nCREATE TABLE department (budget_in_billions INTEGER)\n\n### Response:'}
Traceback (most recent call last):
  File "/home/sam/finetune-llm-for-rag/script-version.py", line 84, in <module>
    model = AutoModelForCausalLM.from_pretrained(
  File "/opt/conda/envs/310/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py", line 563, in from_pretrained
    return model_class.from_pretrained(
  File "/opt/conda/envs/310/lib/python3.10/site-packages/transformers/modeling_utils.py", line 2513, in from_pretrained
    raise ImportError(
ImportError: Using `load_in_8bit=True` requires Accelerate: `pip install accelerate` and the latest version of bitsandbytes `pip install -i https://test.pypi.org/simple/ bitsandbytes` or pip install bitsandbytes` 
